# GraphicsNET

## Что это?
**Внешняя компонента для работы с графическими изображениями**

## ОБЩИЕ СВЕДЕНИЯ
**GraphicsNET** – внешняя компонента для работы с графическими изображениями. Может использоваться для конвертации из одного формата в другой, получения изображения из буфера обмена, изменения размера изображения, поворота (отражения), обрезки, получения размеров и добавления водяного знака.

### Поддерживается работа со следующими форматами:
*В режиме открытия:*
* bmp
* jpg
* png
* gif
* emf (wmf)
* tif

*В режиме сохранения:*
* bmp
* jpg
* png

*Форматы «водяного знака»:*
* bmp
* jpg
* png
* gif
* emf (wmf)
* tif

## Описание свойств и методов

### Свойства:

* **РазмерИзображения/ ImageSize** – размер текущего изображения в формате «Ширина»x»Высота»(например, 300×550). Тип: Строка
* **Ширина/Width** – ширина текущего изображения. Тип: Строка
* **Высота/Height** – высота текущего изображения. Тип: Строка
* **ДвоичныеДанные/ BinaryData** – файл в формате jpg без сжатия представленный в виде строки base64. Тип: Строка

### Методы:

1. **ПолучитьИзображение/GetImage** – получает изображение для обработки (конвертации) из файла или буфера обмена.

- **Параметры:**

- * **ИмяФайла** — имя открываемого для редактирования файла. Если имя файла пустое, то изображение берется из буфера обмена. Тип: Строка

2. **ОбрезатьИзображение/CropImage** – обрезает изображение на указанную величину.

- **Параметры**:

- * **Лево** — количество пикселей (процентов), обрезаемых слева. Тип: Число
- * **Право** — количество пикселей (процентов), обрезаемых справа. Тип: Число
- * **Верх** — количество пикселей (процентов), обрезаемых сверху. Тип: Число
- * **Низ** — количество пикселей (процентов), обрезаемых снизу. Тип: Число
- * **ВПроцентах** – признак того, что все величины указаны в процентах. Тип: Булево

3. **ПовернутьИзображение/RotateImage** – поворачивает (отражает) текущее изображение.

- **Параметры:**

- * **ОтразитьПоГоризонтали** – признак того, что изображение необходимо отразить по горизонтали. Тип: Булево
- * **ОтразитьПоВертикали** — признак того, что изображение необходимо отразить по вертикали. Тип: Булево
- * **Поворот** – поворот изображения (-1 – на 90 градусов против часовой, 1 – на 90 градусов по часовой). Тип: Число

4. **ИзменитьРазмерИзображения/ResizeImage** – изменяет размер изображения.

- **Параметры:**

- * **Ширина** – новая ширина для изображения. Тип: Число
- * **Высота** – новая высота для изображения. Тип: Число
- * **Процент** – процент на который изменяется размер (если число отрицательное – уменьшение изображения, если положительное — увеличение). Тип: Число
- * **СохранятьПропорции** – признак того, что при изменении размера необходимо сохранить пропорции ихображения Если указано, что необходимо сохранить пропорции, то методу передается только один из параметров (либо шинира, либо высота), а второй параметр принимает нулевое значение. Тип: Булево.

5. **ДобавитьВодянойЗнак/ AddWatermark** – добавляет на текущее изображение «водяной знак».

- **Параметры:**

- * **ИмяФайла** – файл, который будет использоваться в качестве водяного знака. Тип: Строка
- * **Позиция** – позиция на текущем изображении, где необходимо разместить водяной знак. Тип: Число
*Принимает следующие значения:*
0 – сверху слева
1 – сверху центр
2 – сверху справа
3 – по центру
4 – снизу слева
5 – снизу центр
6 – снизу справа

- * **Прозрачность** – процент прозрачности накладываемого изображения. Изменяется от 0 до 100. При 100 – изображение непрозрачно. Тип: Число

6. **СохранитьИзображения/SaveImage** – сохраняет изображение в файл на диске.

- **Параметры:**

- * **ИмяФайла** – имя файла для сохранения на диске. Тип: Строка
- * **ТипФайла** – формат сохраняемого файла. Тип: Число
*Принимает следующие значения:*
0 – bmp
1 – jpg
2 – png
- * **Сжатие** – степень сжатия для файлов формата jpg. Тип: Число
- * **УдалятьОригинал** – признак того, что необходимо удалить оригинальный файл. Требуется, например, при конвертации из одного формата в другой. Тип: Булево.

7. **Закрыть/Close** – высвобождает память занятую текущим изображением.

`Для работы компоненты потребуется установленный Microsoft .NET Framework 4.0 и выше`

Регистрация компоненты в Windows - запустить **/reg/reg.bat**
Удаление информации о компоненте - запустить **/reg/unreg.bat**

Прилагаются примеры работы из 1С (7.7 и 8.2/8.3)